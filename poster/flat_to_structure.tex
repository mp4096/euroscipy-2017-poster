\Large

% Flasks
\begin{scope}[xshift = 0 cm, yshift = 7 cm, y = 1 cm]
  \draw[rounded corners = 0.3 cm, fill = aurora 3]
    (2, -0.25) -- ++(-90:0.4) -- ++(-75:3.5) -- ++(180:3.25) -- ++(75:3.5) -- ++(90:0.4);
  \draw[ultra thick, rounded corners = 0.3 cm]
    (2, 0.75) -- ++(-90:1.4) -- ++(-75:3.5) -- ++(180:3.25) -- ++(75:3.5) -- ++(90:1.4);

  \draw[rounded corners = 0.3 cm, fill = aurora 2]
    (0, -1) -- ++(-90:0.4) -- ++(-75:3.5) -- ++(180:3.25) -- ++(75:3.5) -- ++(90:0.4);
  \draw[ultra thick, rounded corners = 0.3 cm]
    (0, 0) -- ++(-90:1.4) -- ++(-75:3.5) -- ++(180:3.25) -- ++(75:3.5) -- ++(90:1.4);

  \draw[aurora 2, fill] (-0.6, 0.7) circle (0.4);
  \draw[aurora 2, fill] (-0.9, 1.4) circle (0.3);
  \draw[aurora 2, fill] (-0.4, 1.9) circle (0.35);
  \draw[aurora 3, fill] (1, 1) circle (0.3);
  \draw[aurora 3, fill] (1.5, 1.6) circle (0.4);
  \draw[aurora 3, fill] (1.2, 2.4) circle (0.35);

  \node at (0.25, -5.5) {Experiment};
\end{scope}


\draw[ultra thick, -{Latex[scale=1.2]}] (3.5, -6) -- (10.5, -6) node[midway, sloped, above] %
  {No structuring};


\begin{scope}[xshift = 12 cm, yshift = 12 cm]
  \pgfmathsetmacro{\LongTableCellHeight}{1}

  % Colourful cells
  \foreach \y/\c/\s in {%
    0/frost 0/B,%
    1/frost 3/C,%
    2/frost 1/A,%
    3/frost 0/B,%
    4/frost 3/C,%
    5/frost 3/C,%
    6/frost 1/A,%
    7/frost 1/A,%
    8/frost 3/C,%
    9/frost 0/B,%
    10/frost 3/C,%
    11/frost 1/A,%
    12/frost 0/B,%
    13/frost 1/A,%
    14/frost 1/A%
    } {
    \draw[\c, fill]
      (4.5, {\LongTableCellHeight*\y}) rectangle +(3, \LongTableCellHeight)
      node[midway, polar night 1] {\s};
  }
  \foreach \y/\c/\s in {%
    0/aurora 0/III,%
    1/aurora 1/II,%
    2/aurora 1/II,%
    3/aurora 2/I,%
    4/aurora 0/III,%
    5/aurora 2/I,%
    6/aurora 0/III,%
    7/aurora 1/II,%
    8/aurora 0/III,%
    9/aurora 2/I,%
    10/aurora 2/I,%
    11/aurora 0/III,%
    12/aurora 0/III,%
    13/aurora 2/I,%
    14/aurora 2/I%
    } {
    \draw[\c, fill]
      (1.5, {\LongTableCellHeight*\y}) rectangle +(3, \LongTableCellHeight)
      node[midway, polar night 1] {\s};
  }

  \node at (4.75, -0.8) {Unstructured data (`long format')};

  % Horizontal lines
  \foreach \y in {0, 1, ..., 15} {
    \draw[thick] (0, {\LongTableCellHeight*\y}) -- +(9.5, 0);
  }
  % Dots
  \foreach \y in {1, 2, ..., 15} {
    \node at (0.5, {\LongTableCellHeight*(\y - 0.5)}) {\y};
    \node at (8.5, {\LongTableCellHeight*(\y - 0.5)}) {\ldots};
  }
\end{scope}


\draw[ultra thick, -{Latex[scale=1.2]}] (13.5, 4) -- +(-10, 6);
\draw[ultra thick, -{Latex[scale=1.2]}] (17.0, 4) -- +(-2, 7.2);
\draw[ultra thick, -{Latex[scale=1.2]}] (20.5, 4) -- +(8, 7.2);
\node[left, align = left] at (9.5, 6) {Late structuring can be\\done on demand\ldots};
\node[align = left] at (20, 7) {\ldots\ into any form\\\hphantom{\ldots\ }you want to!};


% 2D summary
\pgfmathsetmacro{\TwoDimCellSize}{3}
\pgfmathsetmacro{\TwoDimHeaderSize}{1}

\begin{scope}[xshift = -2 cm, yshift = -11 cm]
  \node at ({\TwoDimCellSize*1.5 - \TwoDimHeaderSize*0.5}, {\TwoDimCellSize*3 + 0.8}) %
    {Data grouped by both factors};

  \foreach \y in {0, 1, 2} {
    % A-B-C header
    \foreach \x/\c/\s in {0/frost 1/A, 1/frost 0/B, 2/frost 3/C} {
      \draw[\c, fill]
        ({\TwoDimCellSize*\x}, {\TwoDimCellSize*\y})
        rectangle
        +(\TwoDimCellSize, \TwoDimHeaderSize)
        node[midway, polar night 1] {\s};
    }
  }
  \foreach \y/\c/\s in {0/aurora 2/I, 1/aurora 1/II, 2/aurora 0/III} {
    \draw[\c, fill]
      ({-\TwoDimHeaderSize}, {\TwoDimCellSize*\y}) rectangle +(\TwoDimHeaderSize, \TwoDimCellSize)
      node[midway, polar night 1] {\s};
  }
  \foreach \i in {0, 1, ..., 3} {
    \draw[thick]
      ({-\TwoDimHeaderSize}, {\TwoDimCellSize*\i})
      --
      +({\TwoDimCellSize*3 + \TwoDimHeaderSize}, 0);
    \draw[thick] ({\TwoDimCellSize*\i}, 0) -- +(0, {\TwoDimCellSize*3});
  }

  \begin{scope}[
      xshift = {\TwoDimCellSize*0.5 cm},
      yshift = {-(\TwoDimCellSize + \TwoDimHeaderSize)*0.5 cm},
    ]
    % I
    \node at (0, 0) {14, 15}; % A
    \node at (\TwoDimCellSize, 0) {4, 10}; % B
    \node at ({2*\TwoDimCellSize}, 0) {6, 11}; % C

    % II
    \node at (0, \TwoDimCellSize) {3, 8}; % A
    \node at (\TwoDimCellSize, \TwoDimCellSize) {\LARGE $\boldsymbol{\varnothing}$}; % B
    \node at ({2*\TwoDimCellSize}, \TwoDimCellSize) {2}; % C

    % III
    \node at (0, {2*\TwoDimCellSize}) {7, 12}; % A
    \node at (\TwoDimCellSize, {2*\TwoDimCellSize}) {1, 13}; % B
    \node at ({2*\TwoDimCellSize}, {2*\TwoDimCellSize}) {5, 9}; % C
  \end{scope}
\end{scope}


% 1D summary, I-II-II only
\pgfmathsetmacro{\OneDimLineHeight}{2.5}
\pgfmathsetmacro{\OneDimLineWidth}{6.5}
\pgfmathsetmacro{\OneDimHeaderWidth}{1}

\begin{scope}[xshift = 13 cm, yshift = -12 cm]
  \node at ({\OneDimLineWidth*0.5 - \OneDimHeaderWidth*0.5}, {\OneDimLineHeight*3 + 0.8}) %
    {Data grouped by feature 1};

  \foreach \y/\c/\s in {0/aurora 2/I, 1/aurora 1/II, 2/aurora 0/III} {
    \draw[\c, fill]
      ({-\OneDimHeaderWidth}, {\OneDimLineHeight*\y}) rectangle +(\OneDimHeaderWidth, \OneDimLineHeight)
      node[midway, polar night 1] {\s};
  }
  \foreach \i in {0, 1, ..., 3} {
    \draw[thick] ({-\OneDimHeaderWidth}, {\OneDimLineHeight*\i}) -- +({\OneDimLineWidth + \OneDimHeaderWidth}, 0);
  }
  \draw[thick] (0, 0) -- +(0, {3*\OneDimLineHeight});

  \begin{scope}[xshift = 0.5 cm, yshift = {-\OneDimLineHeight*0.5 cm}, right]
    \node at (0, 0) {4, 6, 10, 11, 14, 15}; % I
    \node at (0, \OneDimLineHeight) {2, 3, 8}; % II
    \node at (0, {2*\OneDimLineHeight}) {1, 5, 9, 7, 12, 13}; % III
  \end{scope}
\end{scope}


% 1D summary, A-B-C only
\begin{scope}[xshift = 26 cm, yshift = -12 cm]
  \node at ({\OneDimLineWidth*0.5 - \OneDimHeaderWidth*0.5}, {\OneDimLineHeight*3 + 0.8}) %
    {Data grouped by feature 2};

  \foreach \y/\c/\s in {0/frost 1/A, 1/frost 0/B, 2/frost 3/C} {
    \draw[\c, fill]
      ({-\OneDimHeaderWidth}, {\OneDimLineHeight*\y}) rectangle +(\OneDimHeaderWidth, \OneDimLineHeight)
      node[midway, polar night 1] {\s};
  }
  \foreach \i in {0, 1, ..., 3} {
    \draw[thick] ({-\OneDimHeaderWidth}, {\OneDimLineHeight*\i}) -- +({\OneDimLineWidth + \OneDimHeaderWidth}, 0);
  }
  \draw[thick] (0, 0) -- +(0, {3*\OneDimLineHeight});

  \begin{scope}[xshift = 0.5 cm, yshift = {-\OneDimLineHeight*0.5 cm}, right]
    \node at (0, 0) {3, 7, 8, 12, 14, 15}; % A
    \node at (0, \OneDimLineHeight) {1, 4, 10, 13}; % B
    \node at (0, {2*\OneDimLineHeight}) {2, 5, 6, 9, 11}; % C
  \end{scope}
\end{scope}
